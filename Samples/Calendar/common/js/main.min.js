function ModalObj(){}function MainMenuObj(){}function ListViewObj(){}function TaskListObj(){}function CalendarObj(){}function CarouselObj(){this.container;
this.gallery;this.page;this.slides;}function FormObj(){this.rangeTickWidth=2;this.progressDottedDotWidth=10;}function MapObj(){this.map;this.view;this.defaultIcon="http://maps.google.com/mapfiles/ms/icons/red-dot.png";
this.userIcon="http://maps.google.com/mapfiles/ms/icons/blue-dot.png";this.initLat=37.775;this.initLng=122.4183;this.markers=new Array();this.openInfowindow=null;
this.userPosition=null;}function ReportObj(){this.svg;this.legendBoxSize=30;this.legendBoxSpacing=10;this.graphType;this.width;this.height;this.jsonURL;
this.json;this.data=[];this.bar={height:700,margin:{top:20,right:20,bottom:200,left:40},valueline:null};this.gauge={value:null,max:null};this.line={height:700,margin:{top:50,right:20,bottom:100,left:60},valueline:null,periods:[10,30],selectedPeriod:0,maxVal:{date:null,total:0},minVal:{date:null,total:99999999999}};
this.axis={x:null,y:null,minorTicks:null,xAxisIndex:null,yAxisIndex:null,xAxis:null,yAxis:null,};}var modalObj=new ModalObj();mainMenuObj=new MainMenuObj(),listViewObj=new ListViewObj(),formObj=new FormObj(),mapObj=new MapObj(),reportObj=new ReportObj();
taskListObj=new TaskListObj();carouselObj=new CarouselObj();calendarObj=new CalendarObj();$(document).ready(function(){init();});$(document).on("onTemplateReady",function(){init();
});function init(){modalObj.init();mainMenuObj.init();listViewObj.init();formObj.init();taskListObj.init();calendarObj.init();}ModalObj.prototype.init=function(){$(".open-modal").click(function(a){a.preventDefault();
$(".modal").fadeIn();});$(".close-modal").click(function(a){a.preventDefault();$(".modal").fadeOut();});};MainMenuObj.prototype.init=function(){var a=this;
a.setupMenuSlider();};MainMenuObj.prototype.setupMenuSlider=function(){$(".main-menu-button-left a.menu").click(function(a){a.preventDefault();$(".app-wrapper").toggleClass("menu-open");
});};ListViewObj.prototype.init=function(){var a=this;a.setupCollapsableMenus();a.setupTabbedLists();a.setupMilestoneLists();a.setupSwipeLis();$(window).on("resize",function(){a.setupTabbedLists();
});$(window).on("orientationchange",function(){a.setupTabbedLists();});};ListViewObj.prototype.setupCollapsableMenus=function(){$.each($("ul.list-view.collapsable > li"),function(){$("> .content",this).click(function(b){b.preventDefault();
var a=$(".list-view-icons span",this).last();if($(this).hasClass("expanded")){$(this).removeClass("expanded").siblings("ul").first().slideUp();a.removeClass("icon-minus").addClass("icon-plus");
}else{$(this).addClass("expanded").siblings("ul").first().slideDown();a.removeClass("icon-plus").addClass("icon-minus");}});});};ListViewObj.prototype.setupTabbedLists=function(){var b=this,a=$("ul.tabbed-list-view");
panels=a.children("li"),tabs=$(".tabbed-list-view-nav a"),tabWidth=tabs.first().width(),arrow=$(".tabbed-list-view-nav-arrow"),ww=panels.first().width();
arrow.css({left:tabWidth/2});$.each(panels,function(){$(this).css({left:(panels.index(this)*ww)+"px"});});tabs.click(function(c){c.preventDefault();$(tabs).removeClass("on");
$(this).addClass("on");a.attr("class","tabbed-list-view").addClass("slide-"+tabs.index(this));arrow.animate({left:(tabWidth/2)+(tabWidth*tabs.index(this))},{queue:false,duration:200});
});};ListViewObj.prototype.setupMilestoneLists=function(){var b=this,a=$(".list-view-milestones");$.each(a,function(){var d=$("li",this),c="<div class='background-fill'></div>";
d.first().prepend(c);d.last().prepend(c);});};ListViewObj.prototype.setupSwipeLis=function(){var b=this,a=$("ul.with-swipe li");if(a.length>0){$("ul.with-swipe li").touchwipe({wipeRight:function(c){$(this.el).addClass("swiped");
},wipeLeft:function(c){$(this.el).removeClass("swiped");},min_move_y:20,preventDefaultEvents:true});}};TaskListObj.prototype.init=function(){var a=this;
a.setupCheckboxes();};TaskListObj.prototype.setupCheckboxes=function(){var a=this,b=$(".list-view-tasks li");$.each(b,function(){var c=this,d=$(".content > .task-complete-checkbox > input",this);
$(".content",this).prepend("<div class='strikethrough'>&nbsp;</div>").prepend("<div class='overdue-color-block'>&nbsp;</div>");d.click(function(){$(c).toggleClass("complete");
$("p",c).slideToggle(200);});});};CalendarObj.prototype.init=function(){var b=this,a=$("ul.week-planner li");a.click(function(){a.removeClass("on");$(this).addClass("on");
$(".date-content").hide();$("#date-content-"+$(this).data("date")).show();});a.first().click();};CarouselObj.prototype.init=function(a){var c=this,b,d;
for(b in a){c[b]=a[b];}document.addEventListener("touchmove",function(f){f.preventDefault();},false);c.gallery=new SwipeView(c.container,{numberOfPages:c.slides.length});
for(b=0;b<3;b++){c.page=b==0?c.slides.length-1:b-1;d=document.createElement("img");d.className="loading";d.src=c.slides[c.page].img;d.width=c.slides[c.page].width;
d.height=c.slides[c.page].height;d.onload=function(){this.className="";};c.gallery.masterPages[b].appendChild(d);d=document.createElement("span");d.innerHTML=c.slides[c.page].desc;
c.gallery.masterPages[b].appendChild(d);}c.gallery.onFlip(function(){var g,e,f;for(f=0;f<3;f++){e=c.gallery.masterPages[f].dataset.upcomingPageIndex;if(e!=c.gallery.masterPages[f].dataset.pageIndex){g=c.gallery.masterPages[f].querySelector("img");
g.className="loading";g.src=c.slides[e].img;g.width=c.slides[e].width;g.height=c.slides[e].height;g=c.gallery.masterPages[f].querySelector("span");g.innerHTML=c.slides[e].desc;
}}});c.gallery.onMoveOut(function(){c.gallery.masterPages[c.gallery.currentMasterPage].className=c.gallery.masterPages[c.gallery.currentMasterPage].className.replace(/(^|\s)swipeview-active(\s|$)/,"");
});c.gallery.onMoveIn(function(){var e=c.gallery.masterPages[c.gallery.currentMasterPage].className;/(^|\s)swipeview-active(\s|$)/.test(e)||(c.gallery.masterPages[c.gallery.currentMasterPage].className=!e?"swipeview-active":e+" swipeview-active");
});};FormObj.prototype.init=function(){var a=this;a.checkDateInputs();a.setupToggles();a.renderRangeTicks();a.renderProgressBar();a.renderProgressDotted();
$(window).on("resize",function(){a.renderProgressDotted();a.renderProgressBar();a.renderRangeTicks();});$(window).on("orientationchange",function(){a.renderProgressBar();
a.renderProgressDotted();a.renderRangeTicks();});};FormObj.prototype.checkDateInputs=function(){var a=document.createElement("input"),b="date";a.setAttribute("type",b);
if(a.type!=b){$.each($(".form-control-date input"),function(){$(this).Zebra_DatePicker();});}};FormObj.prototype.setupToggles=function(){$.each($(".form-control-toggle"),function(){var a=$("input",this).first();
$(this).prepend('<span class="label on"></span><span class="label off"></span><span class="handle">&nbsp;</span>');$(".on",this).html($(this).data("on-label"));
$(".off",this).html($(this).data("off-label"));if(a.prop("checked")==true){$(this).addClass("checked");}$(this).click(function(b){b.preventDefault();$(this).toggleClass("checked");
if(a.prop("checked")==true){a.prop("checked",false);}else{a.prop("checked",true);}});});};FormObj.prototype.renderRangeTicks=function(){var a=this;$.each($(".form-control-range"),function(){var l=1,m=l,f=$(this).width()-(2*l),n=$(this).data("tick-labels").split(","),h=Math.round((f-n.length*a.rangeTickWidth)/(n.length-1)),d=f-(h*(n.length-1)+a.rangeTickWidth*n.length),b=$(".noUiSlider",this).val();
output="<ul>";$(this).html("<div class='noUiSlider'></div>");var c=$(".noUiSlider",this);c.noUiSlider({range:[$(this).data("min"),$(this).data("max")],start:0,step:$(this).data("step"),handles:1});
if(!isNaN(b)){c.val(b);}else{c.val(0);}for(var e=0;e<n.length;e++){var g="",k=0;if(d<0){k=-1;d++;}if(d>0){k=1;d--;}g=" style='left:"+(m)+"px;'";output+="<li"+g+"><span>"+n[e]+"</span></li>";
m+=(h+k+a.rangeTickWidth);}output+="</ul>";$(this).prepend(output);$.each($("ul span",this),function(){$(this).css({top:$(this).height(),left:-($(this).width()/2)+3});
});});};FormObj.prototype.renderProgressBar=function(){var b=this,a='<div class="progress-bar-fill">&nbsp;</div>';$.each($(".progress-bar"),function(){$(this).html(a);
$(".progress-bar-fill",this).css({width:$(this).data("completed")+"%"});});};FormObj.prototype.renderProgressDotted=function(){var a=this;$.each($(".progress-dotted"),function(){var o=$(this).data("completed").split("/"),n=0,f=$(this).width(),g=Math.round((f-o[1]*a.progressDottedDotWidth)/(o[1]-1)),d=f-(g*(o[1]-1)+a.progressDottedDotWidth*o[1]),b=$(".progress-dotted-label",this),l=a.progressDottedDotWidth*(o[0]-0.5)+g*(o[0]-1)-parseInt(b.width())/2,c="<div class='progress-dotted-bg'>&nbsp;</div><ul>";
for(var e=0;e<o[1];e++){var m=(e==o[0]-1?" class='on'":""),h="",k=0;if(e!=0){if(d<0){k=-1;d++;}if(d>0){k=1;d--;}n+=(g+k+a.progressDottedDotWidth);h=" style='left:"+(n)+"px;'";
}c+="<li"+m+h+">&nbsp;</li>";}c+="</ul>";if(l<0){l=0;}if(l>f-b.width()){l=f-b.width();}b.css({left:l});$("ul",this).remove();$(this).prepend(c);});};MapObj.prototype.init=function(a){var b=this;
b.view=a.view;b.setupMap(a);b.setupMarkerLinks();$(window).on("resize",function(){b.updateWrapperDimensions();google.maps.event.trigger(b.map,"resize");
b.resetMarkerBounds();});};MapObj.prototype.setupMap=function(a){var b=this;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(c){b.userPosition=c;
b.initLat=c.coords.latitude;b.initLng=c.coords.longitude;b.setupMapView();a.markers.push({id:"theCaptain",icon:b.userIcon,lat:c.coords.latitude,lng:c.coords.longitude});
b.addMarkers(a.markers);},function(){b.setupMapView();b.addMarkers(a.markers);});}else{b.setupMapView();b.addMarkers(a.markers);}};MapObj.prototype.setupMapView=function(){var b=this,a={zoom:8,center:new google.maps.LatLng(b.initLat,b.initLng),mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:false,zoomControl:false,mapTypeControl:false,scaleControl:false,streetViewControl:false,overviewMapControl:false};
$("#map-canvas-wrapper").html('<div id="map-canvas" class="map-canvas"></div>');b.updateWrapperDimensions();b.map=new google.maps.Map(document.getElementById("map-canvas"),a);
};MapObj.prototype.updateWrapperDimensions=function(){t=this,appContentEl=$(".app-content"),mapCanvasWrapperEl=$("#map-canvas-wrapper"),wh=$(window).height(),contentBottomPosition=appContentEl.height();
if(t.view=="fullView"){appContentEl.css({height:$(window).height()});mapCanvasWrapperEl.css({height:"100%"});}if(t.view=="listView"){$(appContentEl).css({height:wh-mapCanvasWrapperEl.height()-appContentEl.offset().top,"overflow-x":"hidden","overflow-y":"scroll"});
if(contentBottomPosition>wh){$("body").css({marginBottom:mapCanvasWrapperEl.height()});}if(contentBottomPosition<wh&&(wh-contentBottomPosition)<mapCanvasWrapperEl.height()){$("body").css({marginBottom:mapCanvasWrapperEl.height()-(wh-contentBottomPosition)});
}}};MapObj.prototype.addMarkers=function(a){var d=this;for(var c in a){var f=new google.maps.LatLng(a[c].lat,a[c].lng),b=new google.maps.Marker({visible:(a[c].visible?a[c].visible:false),position:f,icon:(a[c].icon?a[c].icon:d.defaultIcon),map:d.map}),g=d.getDistanceToUser(f);
if(a[c].contentString){var e=new google.maps.InfoWindow;d.bindInfoWindowToMarker(b,a[c].contentString,e);}d.markers.push({id:a[c].id,marker:b,distanceToUser:g});
}google.maps.event.addListenerOnce(d.map,"idle",function(){if(d.view=="listView"){$("a[data-map-id]").first().click();}else{d.showMarkers();}});};MapObj.prototype.showMarkers=function(d){var c=this,a=new google.maps.LatLngBounds();
for(var b in c.markers){if(!isNaN(d)){c.markers[b].marker.setVisible(false);if(c.markers[b].id==d){c.markers[b].marker.setVisible(true);c.map.setCenter(c.markers[b].marker.position);
c.map.setZoom(17);google.maps.event.trigger(c.markers[b].marker,"click");}}else{c.markers[b].marker.setVisible(true);a.extend(c.markers[b].marker.position);
}}if(isNaN(d)){c.map.fitBounds(a);}};MapObj.prototype.resetMarkerBounds=function(){var c=this,a=new google.maps.LatLngBounds();for(var b in c.markers){if(c.markers[b].marker.getVisible()==true){a.extend(c.markers[b].marker.position);
}}c.map.fitBounds(a);};MapObj.prototype.setupMarkerLinks=function(){var a=this;listViewMarkerLinks=$("a[data-map-id]");listViewMarkerLinks.click(function(b){b.preventDefault();
$(".icon-map-dot").hide();$(".icon-map-dot",this).show();a.showMarkers($(this).data("map-id"));});};MapObj.prototype.bindInfoWindowToMarker=function(a,d,c){var b=this;
google.maps.event.addListener(a,"click",function(){if(b.openInfowindow!=null){b.openInfowindow.close();}b.openInfowindow=c;c.setContent(d);c.open(b.map,a);
});};MapObj.prototype.getDistanceToUser=function(b){var a=this;if(!a.userPosition){return"N/A";}else{return a.distHaversine(b)+" miles away";}};MapObj.prototype.rad=function(a){return a*Math.PI/180;
};MapObj.prototype.distHaversine=function(b){var o=this,n={lat:o.userPosition.coords.latitude,lng:o.userPosition.coords.longitude},l={lat:b.lat(),lng:b.lng()},e=3958.756,g=o.rad(l.lat-n.lat),m=o.rad(l.lng-n.lng),k=Math.sin(g/2)*Math.sin(g/2)+Math.cos(o.rad(n.lat))*Math.cos(o.rad(l.lat))*Math.sin(m/2)*Math.sin(m/2),h=2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)),f=e*h;
return f.toFixed(1);};ReportObj.prototype.init=function(a){var c=this;for(var b in a){if(a[b] instanceof Object){for(j in a[b]){c[b][j]=a[b][j];}}else{c[b]=a[b];
}}c["render"+c.graphType.charAt(0).toUpperCase()+c.graphType.slice(1)+"Graph"]();};ReportObj.prototype.getGraphData=function(){var c=this;c.data=[];if(c.graphType=="bar"){c.json.forEach(function(e){c.data.push({variable:+e[c.axis.yAxisIndex],xAxisIndex:e[c.axis.xAxisIndex]});
});}if(c.graphType=="line"){var b=new Date(),a=new Date();a.setDate(a.getDate()-c.line.periods[c.line.selectedPeriod]-2);c.json.forEach(function(f){var e=new Date(f.date);
if(e.getTime()>=a.getTime()&&e.getTime()<=b.getTime()){console.log(e.getTime());c.data.push({date:f[c.axis.xAxisIndex],total:+f[c.axis.yAxisIndex]});if(+f[c.axis.yAxisIndex]>c.line.maxVal.total){c.line.maxVal={date:f[c.axis.xAxisIndex],total:+f[c.axis.yAxisIndex]};
}if(+f[c.axis.yAxisIndex]<c.line.minVal.total){c.line.minVal={date:f[c.axis.xAxisIndex],total:+f[c.axis.yAxisIndex]};}}});}};ReportObj.prototype.renderBarGraph=function(){var a=this;
a.width=$("#graph").width()-a.bar.margin.left-a.bar.margin.right;a.height=a.bar.height-a.bar.margin.top-a.bar.margin.bottom;a.axis.x=d3.scale.ordinal().rangeRoundBands([0,a.width],0.1);
a.axis.y=d3.scale.linear().range([a.height,0]);a.axis.xAxis=d3.svg.axis().scale(a.axis.x).orient("bottom");a.axis.yAxis=d3.svg.axis().scale(a.axis.y).orient("left");
a.svg=d3.select("#graph").append("svg").attr("width",a.width+a.bar.margin.left+a.bar.margin.right).attr("height",a.height+a.bar.margin.top+a.bar.margin.bottom).append("g").attr("transform","translate("+a.bar.margin.left+","+a.bar.margin.top+")");
a.bar.valueline=d3.svg.line().x(function(b){return x(b.xAxisIndex);}).y(function(b){return y(b.variable);});d3.json("json/products.json",function(c,b){a.json=b;
a.getGraphData();a.axis.x.domain(a.data.map(function(e){return e.xAxisIndex;}));a.axis.y.domain([0,d3.max(a.data,function(e){return e.variable;})]);a.svg.append("g").attr("class","x axis").attr("transform","translate(0,"+a.height+")").style("fill","#ccc").call(a.axis.xAxis).selectAll("text").style("text-anchor","end").attr("x",-10).attr("dy","-0.25em").attr("transform",function(e){return"rotate(-90)";
});a.svg.append("g").attr("class","y axis").call(a.axis.yAxis);a.svg.selectAll(".bar").data(a.data).enter().append("rect").attr("class","bar").attr("x",function(e){return a.axis.x(e.xAxisIndex);
}).attr("width",a.axis.x.rangeBand()).attr("y",function(e){return a.axis.y(e.variable);}).attr("height",function(e){return a.height-a.axis.y(e.variable);
});a.svg.selectAll(".bar-values").data(a.data).enter().append("text").attr("class","bar-values").text(function(e){return e.variable;}).style("text-anchor","end").attr("transform",function(e){return"rotate(-90)";
}).attr("x",function(f,e){return -a.axis.y(f.variable)-10;}).attr("y",function(f,e){return e*(a.width/a.data.length)+a.axis.x.rangeBand()/2+17-e*1;});a.addBarGraphSelect();
});};ReportObj.prototype.updateBarGraph=function(d){var c=this;c.axis.yAxisIndex=d;c.getGraphData();c.axis.x.domain(c.data.map(function(f){return f.xAxisIndex;
}));c.axis.y.domain([0,d3.max(c.data,function(f){return f.variable;})]);var b=d3.select("#graph").transition(),e=c.svg.transition().duration(750),a=function(g,f){return f*50;
};c.svg.selectAll(".bar").data(c.data).transition().duration(750).attr("y",function(f){return c.axis.y(f.variable);}).attr("height",function(f){return c.height-c.axis.y(f.variable);
});c.svg.selectAll(".bar-values").data(c.data).text(function(f){return f.variable;}).transition().duration(750).attr("x",function(g,f){return -c.axis.y(g.variable)-10;
});e.select(".y.axis").call(c.axis.yAxis);};ReportObj.prototype.addBarGraphSelect=function(){var c=this,a="<select type='select' onchange='reportObj.updateBarGraph(value);'>",e=0;
for(var b in c.json[0]){if(b!=c.bar.xAxisIndex){var d=(e==1?" selected='true'":"");a+="<option value='"+b+"' name='"+b+"'"+d+">"+b.replace("_"," ")+"</option>";
}e++;}a+="</select>";$("#graph-data-select").html(a);};ReportObj.prototype.renderGaugeGraph=function(){var b=this,a={size:b.width,label:"",max:b.gauge.max||100,minorTicks:b.axis.minorTicks};
a.redZones=[];a.redZones.push({from:0,to:a.max/3});a.yellowZones=[];a.yellowZones.push({from:a.max/3,to:a.max/3*2});a.greenZones=[];a.greenZones.push({from:a.max/3*2,to:a.max});
b.svg=new Gauge("graph",a);b.svg.render();b.svg.redraw(b.gauge.value);};ReportObj.prototype.renderDonutGraph=function(){var c=this;c.width=c.width||$("#graph").width();
c.height=c.height||350;var a=Math.min(c.width,c.height)/2;var b=a/2+50;d3.json(c.jsonURL,function(g,d){c.json=d;var k=new Array();var l=0;for(i in c.json){k.push(c.json[i]["value"]);
l+=c.json[i]["value"];}c.svg=d3.select("#graph").append("svg").attr("width",c.width).attr("height",c.height+(c.json.length*(c.legendBoxSize+c.legendBoxSpacing))).append("g").attr("transform","translate("+c.width/2+","+(c.height/2-40)+")");
var f=d3.scale.category20();var e=d3.layout.pie().sort(null);var h=d3.svg.arc().innerRadius(a-100).outerRadius(a-50);var m=c.svg.selectAll("path").data(e(k)).enter().append("path").attr("fill",function(o,n){return f(n);
}).attr("d",h);c.svg.selectAll(".legend-box").data(c.json).enter().append("rect").attr("class","legend-box").attr("fill",function(o,n){return f(n);}).attr("x",function(n){return -b;
}).attr("y",function(o,n){return c.height/2+(c.legendBoxSize+c.legendBoxSpacing)*n;}).attr("width",c.legendBoxSize).attr("height",c.legendBoxSize);c.svg.selectAll(".legend-text").data(c.json).enter().append("text").attr("class","legend-text").attr("x",function(n){return -b+(c.legendBoxSize+c.legendBoxSpacing);
}).attr("y",function(o,n){return c.height/2+(c.legendBoxSize+c.legendBoxSpacing)*n;}).attr("dy",c.legendBoxSize/2+5).text(function(o,n){return o.index+" ("+o.value+")";
});c.svg.selectAll(".donut-center-text").data([l]).enter().append("text").attr("class","donut-center-text").attr("x",0).attr("y",10).attr("text-anchor","middle").text(function(n){return n;
});});};ReportObj.prototype.renderLineGraph=function(){var a=this;a.width=a.width||$("#graph").width();a.height=a.height||350;a.height+=150;a.svg=d3.select("#graph").append("svg").attr("width",a.width+a.line.margin.left+a.line.margin.right).attr("height",a.height+a.line.margin.top+a.line.margin.bottom).append("g").attr("transform","translate("+a.line.margin.left+","+a.line.margin.top+")");
d3.json(a.jsonURL,function(c,b){a.json=b;a.getGraphData();a.axis.x=d3.time.scale().domain([new Date(a.data[0].date),new Date(a.data[a.data.length-1].date)]).rangeRound([0,a.width-a.line.margin.left-a.line.margin.right]);
a.axis.y=d3.scale.linear().domain([0,d3.max(a.data,function(e){return e.total;})]).range([a.height-a.line.margin.top-a.line.margin.bottom,0]);a.line.valueline=d3.svg.line().x(function(e){return a.axis.x(new Date(e.date));
}).y(function(e){return a.axis.y(e.total);});a.axis.xAxis=d3.svg.axis().scale(a.axis.x).orient("bottom").ticks(d3.time.days,Math.round(a.data.length/4)).tickFormat(d3.time.format("%b %d")).tickSize(0).tickPadding(8);
a.axis.yAxis=d3.svg.axis().scale(a.axis.y).orient("left").tickPadding(8);a.svg.append("path").attr("class","graph-line").attr("d",a.line.valueline(a.data));
a.svg.append("g").attr("class","x axis").attr("transform","translate(0, "+(a.height-a.line.margin.top-a.line.margin.bottom)+")").call(a.axis.xAxis).selectAll("text").style("text-anchor","end").attr("x",-10).attr("dy","1em").attr("transform",function(e){return"rotate(-90)";
});a.svg.append("g").attr("class","y axis").call(a.axis.yAxis);a.svg.append("text").attr("class","max-text-title").attr("x",function(e){return 0;}).attr("y",function(f,e){return a.height-40;
}).text(function(f,e){return"HIGH";});a.svg.selectAll(".max-text").data([a.line.maxVal]).enter().append("text").attr("class","max-text").attr("x",function(e){return 70;
}).attr("y",function(f,e){return a.height-40;}).text(function(g,e){var f=d3.time.format("%b %d");return g.total+" on "+f(new Date(g.date));});a.svg.append("text").attr("class","min-text-title").attr("x",function(e){return 0;
}).attr("y",function(f,e){return a.height-20;}).text(function(f,e){return"LOW";});a.svg.selectAll(".min-text").data([a.line.minVal]).enter().append("text").attr("class","min-text").attr("x",function(e){return 70;
}).attr("y",function(f,e){return a.height-20;}).text(function(g,e){var f=d3.time.format("%b %d");return g.total+" on "+f(new Date(g.date));});});a.addLineGraphSelect();
};ReportObj.prototype.updateLineGraph=function(d){var c=this;c.line.selectedPeriod=d;c.getGraphData();c.axis.x.domain([new Date(c.data[0].date),new Date(c.data[c.data.length-1].date)]);
c.axis.y.domain([0,d3.max(c.data,function(f){return f.total;})]);c.axis.xAxis.scale(c.axis.x).ticks(d3.time.days,Math.ceil(c.data.length/4));var b=d3.select("#graph").transition(),e=c.svg.transition().duration(750),a=function(g,f){return f*50;
};c.svg.selectAll(".x.axis").call(c.axis.xAxis).selectAll("text").style("text-anchor","end").attr("x",-10).attr("dy","1em").attr("transform",function(f){return"rotate(-90)";
});e.select(".y.axis").call(c.axis.yAxis);c.svg.selectAll(".graph-line").data(c.data).transition().duration(750).attr("d",c.line.valueline(c.data));c.svg.selectAll(".max-text").data([c.line.maxVal]).text(function(h,f){var g=d3.time.format("%b %d");
return h.total+" on "+g(new Date(h.date));});c.svg.selectAll(".min-text").data([c.line.minVal]).text(function(h,f){var g=d3.time.format("%b %d");return h.total+" on "+g(new Date(h.date));
});};ReportObj.prototype.addLineGraphSelect=function(){var c=this,a="<select type='select' onchange='reportObj.updateLineGraph(value);'>",e=0;for(var b in c.line.periods){var d=(e==0?" selected='true'":"");
a+="<option value='"+b+"' name='"+b+"'"+d+">Past "+c.line.periods[b]+" days</option>";e++;}a+="</select>";$("#graph-data-select").html(a);};