function Gauge(b,c){this.placeholderName=b;var a=this;this.configure=function(d){this.config=d;this.config.size=this.config.size*0.9;this.config.raduis=this.config.size*0.97/2;
this.config.cx=this.config.size/2;this.config.cy=this.config.size/2;this.config.min=d.min||0;this.config.max=d.max||100;this.config.range=this.config.max-this.config.min;
this.config.majorTicks=d.majorTicks||5;this.config.minorTicks=d.minorTicks||2;this.config.greenColor=d.greenColor||"#109618";this.config.yellowColor=d.yellowColor||"#FF9900";
this.config.redColor=d.redColor||"#DC3912";};this.render=function(){this.body=d3.select("#"+this.placeholderName).append("svg:svg").attr("class","gauge").attr("width",this.config.size).attr("height",this.config.size);
this.body.append("svg:circle").attr("cx",this.config.cx).attr("cy",this.config.cy).attr("r",this.config.raduis).style("fill","#ccc").style("stroke","#000").style("stroke-width","0.5px");
this.body.append("svg:circle").attr("cx",this.config.cx).attr("cy",this.config.cy).attr("r",0.9*this.config.raduis).style("fill","#fff").style("stroke","#e0e0e0").style("stroke-width","2px");
for(var h in this.config.greenZones){this.drawBand(this.config.greenZones[h].from,this.config.greenZones[h].to,a.config.greenColor);}for(var h in this.config.yellowZones){this.drawBand(this.config.yellowZones[h].from,this.config.yellowZones[h].to,a.config.yellowColor);
}for(var h in this.config.redZones){this.drawBand(this.config.redZones[h].from,this.config.redZones[h].to,a.config.redColor);}if(undefined!=this.config.label){var m=Math.round(this.config.size/9);
this.body.append("svg:text").attr("x",this.config.cx).attr("y",this.config.cy/2+m/2).attr("dy",m/2).attr("text-anchor","middle").text(this.config.label).style("font-size",m+"px").style("fill","#333").style("stroke-width","0px");
}var m=Math.round(this.config.size/16);var g=this.config.range/(this.config.majorTicks-1);for(var j=this.config.min;j<=this.config.max;j+=g){var e=g/this.config.minorTicks;
for(var f=j+e;f<Math.min(j+g,this.config.max);f+=e){var k=this.valueToPoint(f,0.75);var i=this.valueToPoint(f,0.85);this.body.append("svg:line").attr("x1",k.x).attr("y1",k.y).attr("x2",i.x).attr("y2",i.y).style("stroke","#666").style("stroke-width","1px");
}var k=this.valueToPoint(j,0.7);var i=this.valueToPoint(j,0.85);this.body.append("svg:line").attr("x1",k.x).attr("y1",k.y).attr("x2",i.x).attr("y2",i.y).style("stroke","#333").style("stroke-width","2px");
if(j==this.config.min||j==this.config.max){var l=this.valueToPoint(j,0.63);this.body.append("svg:text").attr("x",l.x).attr("y",l.y).attr("dy",m/3).attr("text-anchor",j==this.config.min?"start":"end").text(j).style("font-size",m+"px").style("fill","#333").style("stroke-width","0px");
}}var d=this.body.append("svg:g").attr("class","pointerContainer");this.drawPointer(0);d.append("svg:circle").attr("cx",this.config.cx).attr("cy",this.config.cy).attr("r",0.12*this.config.raduis).style("fill","#4684EE").style("stroke","#666").style("opacity",1);
};this.redraw=function(d){this.drawPointer(d);};this.drawBand=function(f,d,e){if(0>=d-f){return;}this.body.append("svg:path").style("fill",e).attr("d",d3.svg.arc().startAngle(this.valueToRadians(f)).endAngle(this.valueToRadians(d)).innerRadius(0.65*this.config.raduis).outerRadius(0.85*this.config.raduis)).attr("transform",function(){return"translate("+a.config.cx+", "+a.config.cy+") rotate(270)";
});};this.drawPointer=function(n){var o=this.config.range/13;var l=this.valueToPoint(n,0.85);var m=this.valueToPoint(n-o,0.12);var k=this.valueToPoint(n+o,0.12);
var f=n-(this.config.range*(1/(270/360))/2);var h=this.valueToPoint(f,0.28);var j=this.valueToPoint(f-o,0.12);var i=this.valueToPoint(f+o,0.12);var g=[l,m,i,h,j,k,l];
var q=d3.svg.line().x(function(r){return r.x;}).y(function(r){return r.y;}).interpolate("basis");var e=this.body.select(".pointerContainer");var d=e.selectAll("path").data([g]);
d.enter().append("svg:path").attr("d",q).style("fill","#dc3912").style("stroke","#c63310").style("fill-opacity",0.7);d.transition().attr("d",q);var p=Math.round(this.config.size/10);
e.selectAll("text").data([n]).text(Math.round(n)).enter().append("svg:text").attr("x",this.config.cx).attr("y",this.config.size-this.config.cy/4-p).attr("dy",p/2).attr("text-anchor","middle").text(Math.round(n)).style("font-size",p+"px").style("fill","#000").style("stroke-width","0px");
};this.valueToDegrees=function(d){return d/this.config.range*270-45;};this.valueToRadians=function(d){return this.valueToDegrees(d)*Math.PI/180;};this.valueToPoint=function(f,e){var d={x:this.config.cx-this.config.raduis*e*Math.cos(this.valueToRadians(f)),y:this.config.cy-this.config.raduis*e*Math.sin(this.valueToRadians(f))};
return d;};this.configure(c);}